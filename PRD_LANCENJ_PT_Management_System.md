# LANCENJ PT 관리 시스템 PRD (Product Requirements Document)

## 1. 프로젝트 개요

### 1.1 제품명
**LANCENJ PT 관리 시스템** (Personal Training Management System)

### 1.2 제품 목적
PT 스튜디오의 종합적인 운영 관리를 위한 웹 기반 관리 시스템으로, 회원 관리, 강사 관리, 프로그램 관리, 스케줄 관리, 정산 관리 등의 핵심 기능을 제공합니다.

### 1.3 타겟 사용자
- **관리자 (Admin)**: 전체 시스템 관리 권한
- **매니저 (Manager)**: 지점별 관리 권한
- **강사 (Trainer)**: 개인 스케줄 및 회원 관리 권한

### 1.4 기술 스택
- **Frontend**: React 18.3.1 + TypeScript
- **Backend**: Supabase (PostgreSQL + Auth + Real-time)
- **Build Tool**: Vite 6.2.0
- **UI Framework**: Tailwind CSS
- **Testing**: Vitest + Testing Library
- **Deployment**: Vercel

## 2. 핵심 기능 요구사항

### 2.1 인증 및 권한 관리

#### 2.1.1 사용자 인증
- **로그인/로그아웃**: 이메일/비밀번호 기반 인증
- **회원가입**: 강사 자동 등록 시스템
- **세션 관리**: 자동 세션 복원 및 유지
- **비밀번호 재설정**: 이메일 기반 비밀번호 재설정

#### 2.1.2 역할 기반 접근 제어 (RBAC)
- **Admin**: 전체 시스템 관리, 모든 지점 접근 가능
- **Manager**: 할당된 지점만 관리 가능
- **Trainer**: 본인 담당 회원 및 스케줄만 관리 가능

### 2.2 회원 관리

#### 2.2.1 회원 정보 관리
- **기본 정보**: 이름, 연락처, 소속 지점
- **상세 정보**: 운동 목표, 동기, 의료 이력, 운동 경력, 선호 시간대, 직업, 메모
- **담당 강사 배정**: 회원별 담당 강사 지정
- **추천인 관리**: 추천인 정보 추적

#### 2.2.2 회원 상태 관리
- **활성 상태**: 최근 14일 이내 활동
- **휴면 예상**: 14일 이상 활동 없음
- **비활성**: 유효한 프로그램 없음
- **자동 상태 계산**: 활동 기반 자동 상태 업데이트

#### 2.2.3 회원 데이터 관리
- **CRUD 작업**: 생성, 조회, 수정, 삭제
- **CSV 내보내기**: 회원 데이터 일괄 다운로드
- **지점별 필터링**: 지점별 회원 조회
- **검색 및 정렬**: 다양한 조건으로 회원 검색

### 2.3 강사 관리

#### 2.3.1 강사 정보 관리
- **기본 정보**: 이름, 프로필 사진, 색상 코드
- **지점별 수업료**: 지점별 차등 수업료 설정 (비율/고정금액)
- **소속 지점**: 다중 지점 소속 가능
- **활성 상태**: 강사 활성/비활성 관리

#### 2.3.2 드래그 앤 드롭 강사 관리
- **활성 강사 영역**: 현재 활성화된 강사 목록 표시
- **비활성 강사 영역**: 비활성 강사 드롭 존
- **드래그 앤 드롭 기능**:
  - **활성화**: 비활성 → 활성 강사 영역으로 드래그
  - **비활성화**: 활성 → 비활성 강사 영역으로 드래그
  - **시각적 피드백**: 드래그 중 시각적 상태 표시
- **강사 상태 표시**:
  - **온라인 상태**: 초록색 점 아이콘으로 활성 강사 표시
  - **수업료 정보**: 강사별 수업료 (예: 30,000원, 50%, 25,000원)
- **강사 관리 액션**:
  - **설정 아이콘**: 강사 정보 수정
  - **삭제 아이콘**: 강사 삭제 (휴지통 아이콘)

#### 2.3.3 강사 정산 관리
- **수업료 계산**: 지점별 요율 또는 고정 금액
- **정산 기간별 조회**: 월별, 기간별 정산 내역
- **수업 완료 추적**: 완료된 수업 기반 정산

### 2.4 프로그램 관리

#### 2.4.1 프로그램 등록
- **회원 연결**: 다중 회원 동시 등록 가능
- **프로그램 정보**: 프로그램명, 등록 유형 (신규/재등록)
- **결제 정보**: 총 금액, 총 세션 수, 단가, 결제일
- **강사 배정**: 프로그램별 담당 강사 지정
- **상태 관리**: 유효/정지/만료 상태

#### 2.4.2 프로그램 프리셋
- **프리셋 생성**: 자주 사용하는 프로그램 템플릿
- **지점별 프리셋**: 지점별 차별화된 프리셋
- **회차별 수업료**: 세션별 차등 수업료 설정
- **고정 강사료**: 요율 무시 고정 강사료 설정

#### 2.4.3 프로그램 재등록
- **기존 프로그램 복사**: 기존 프로그램 기반 재등록
- **정보 수정**: 필요시 정보 수정 후 등록
- **이력 추적**: 재등록 이력 관리

### 2.5 스케줄 관리

#### 2.5.1 세션 관리
- **세션 생성**: 프로그램 기반 세션 자동 생성
- **세션 정보**: 날짜, 시간, 지속시간, 강사, 참석 회원
- **세션 상태**: 예약/완료 상태 관리
- **세션 완료**: 수업 완료 처리 및 정산 계산

#### 2.5.2 블록 기반 세션 관리
- **세션 블록 시각화**: 1-8개 블록으로 세션 진행률 표시
- **블록 상태 표시**:
  - **완료된 세션**: 초록색 체크(✓) 표시
  - **진행 중인 세션**: 주황색 배경에 현재 세션 번호
  - **남은 세션**: 회색 배경에 세션 번호
  - **특별 상태**: 파란색 체크(✓) 표시 (특별 완료)
- **세션 진행률**: 실시간 진행률 업데이트
- **세션 상태 관리**: 유효/만료 상태 시각적 표시

#### 2.5.3 캘린더 뷰
- **다양한 뷰**: 일별/주별/월별/강사별 뷰
- **드래그 앤 드롭**: 강사 배정 변경
- **세션 상세**: 세션 클릭 시 상세 정보 표시
- **시간대 표시**: 6시~23시 시간대 표시

#### 2.5.4 세션 트래킹
- **진행률 표시**: 프로그램별 세션 진행률
- **잔여 세션**: 남은 세션 수 표시
- **마지막 수업일**: 최근 수업일 추적
- **경과 시간**: 마지막 업데이트부터 경과 시간 표시

### 2.6 정산 관리

#### 2.6.1 강사 정산
- **기간별 정산**: 선택 기간별 정산 내역
- **강사별 통계**: 강사별 수업 횟수 및 수업료
- **지점별 필터링**: 지점별 정산 조회
- **정산 내역**: 완료된 세션 기반 정산

#### 2.6.2 수업료 계산
- **요율 기반**: 지점별 요율에 따른 계산
- **고정 금액**: 고정 강사료 설정
- **회차별 차등**: 세션별 차등 수업료
- **자동 계산**: 세션 완료 시 자동 정산

### 2.7 지점 관리

#### 2.7.1 지점 정보
- **지점 등록**: 지점명, 생성일
- **지점별 데이터**: 지점별 회원, 강사, 프로그램 관리
- **지점별 필터링**: 모든 기능에서 지점별 필터링

### 2.8 감사 로그

#### 2.8.1 활동 추적
- **사용자 활동**: 모든 CRUD 작업 로깅
- **상세 정보**: 사용자, 액션, 엔티티, 상세 내용
- **지점별 로그**: 지점별 활동 추적
- **시간순 정렬**: 최신 활동 우선 표시

## 3. 사용자 인터페이스 요구사항

### 3.1 반응형 디자인
- **모바일 최적화**: 모바일 우선 반응형 디자인
- **태블릿 지원**: 태블릿 화면 최적화
- **데스크톱 지원**: 대화면 효율적 활용

### 3.2 사용자 경험 (UX)
- **직관적 네비게이션**: 사이드바 기반 메뉴 구조
- **빠른 액세스**: 주요 기능 빠른 접근
- **시각적 피드백**: 상태별 색상 코딩
- **드래그 앤 드롭**: 직관적인 강사 배정 및 관리
- **블록 기반 시각화**: 세션 진행률을 한눈에 파악
- **실시간 상태 업데이트**: 세션 상태 및 강사 상태 실시간 반영

### 3.3 접근성 (A11y)
- **키보드 네비게이션**: 키보드만으로 모든 기능 접근
- **스크린 리더 지원**: 시각 장애인 접근성
- **색상 대비**: 충분한 색상 대비
- **텍스트 크기**: 가독성 높은 텍스트 크기

## 4. 데이터 모델

### 4.1 핵심 엔티티
- **User**: 사용자 정보 및 권한
- **Branch**: 지점 정보
- **Member**: 회원 정보
- **Trainer**: 강사 정보
- **MemberProgram**: 회원 프로그램
- **Session**: 수업 세션
- **SessionBlock**: 세션 블록 상태 (진행률 관리)
- **ProgramPreset**: 프로그램 프리셋
- **AuditLog**: 감사 로그

### 4.2 관계 모델
- **User ↔ Trainer**: 1:1 관계 (강사 사용자)
- **Branch ↔ Member**: 1:N 관계
- **Branch ↔ Trainer**: N:M 관계
- **Member ↔ MemberProgram**: N:M 관계
- **MemberProgram ↔ Session**: 1:N 관계
- **MemberProgram ↔ SessionBlock**: 1:N 관계 (세션 블록 관리)
- **Trainer ↔ Session**: 1:N 관계
- **Trainer ↔ TrainerStatus**: 1:1 관계 (활성/비활성 상태)

## 5. 성능 요구사항

### 5.1 응답 시간
- **페이지 로딩**: 3초 이내
- **데이터 조회**: 1초 이내
- **CRUD 작업**: 2초 이내

### 5.2 동시 사용자
- **최대 동시 사용자**: 50명
- **데이터베이스 연결**: 효율적인 연결 풀 관리

### 5.3 데이터 처리
- **대용량 데이터**: 페이징 및 가상화
- **실시간 업데이트**: Supabase Real-time 활용
- **오프라인 지원**: 기본적인 오프라인 기능

## 6. 보안 요구사항

### 6.1 인증 보안
- **JWT 토큰**: 안전한 세션 관리
- **비밀번호 암호화**: 해시 기반 비밀번호 저장
- **세션 만료**: 자동 세션 만료 처리

### 6.2 데이터 보안
- **RLS (Row Level Security)**: Supabase RLS 활용
- **API 보안**: 인증된 사용자만 API 접근
- **데이터 암호화**: 민감 정보 암호화

### 6.3 접근 제어
- **역할 기반 권한**: 세분화된 권한 관리
- **지점별 격리**: 지점별 데이터 격리
- **감사 추적**: 모든 활동 로깅

## 7. 통합 요구사항

### 7.1 외부 서비스
- **Supabase**: 백엔드 서비스 통합
- **Vercel**: 배포 및 호스팅
- **이메일 서비스**: 비밀번호 재설정 등

### 7.2 API 설계
- **RESTful API**: 표준 REST API 설계
- **GraphQL**: 필요시 GraphQL 지원
- **실시간 통신**: WebSocket 기반 실시간 업데이트

## 8. 테스트 요구사항

### 8.1 단위 테스트
- **컴포넌트 테스트**: React 컴포넌트 테스트
- **유틸리티 테스트**: 헬퍼 함수 테스트
- **서비스 테스트**: 비즈니스 로직 테스트

### 8.2 통합 테스트
- **API 테스트**: 백엔드 API 테스트
- **데이터베이스 테스트**: 데이터 무결성 테스트
- **인증 테스트**: 로그인/로그아웃 테스트

### 8.3 E2E 테스트
- **사용자 시나리오**: 주요 사용자 플로우 테스트
- **크로스 브라우저**: 다양한 브라우저 테스트
- **모바일 테스트**: 모바일 환경 테스트

## 9. 배포 및 운영 요구사항

### 9.1 배포 환경
- **개발 환경**: 로컬 개발 환경
- **스테이징 환경**: 테스트 환경
- **프로덕션 환경**: 운영 환경

### 9.2 모니터링
- **성능 모니터링**: 응답 시간 및 오류 추적
- **사용자 모니터링**: 사용자 활동 분석
- **시스템 모니터링**: 서버 상태 모니터링

### 9.3 백업 및 복구
- **데이터 백업**: 정기적 데이터 백업
- **재해 복구**: 장애 시 복구 계획
- **버전 관리**: 코드 버전 관리

## 10. 향후 확장 계획

### 10.1 단기 계획 (3개월)
- **모바일 앱**: React Native 기반 모바일 앱
- **알림 시스템**: 이메일/SMS 알림
- **결제 통합**: 온라인 결제 시스템
- **세션 블록 고도화**: 세션별 상세 메모 및 첨부파일 기능
- **드래그 앤 드롭 확장**: 세션 일정 변경을 위한 드래그 앤 드롭

### 10.2 중기 계획 (6개월)
- **분석 대시보드**: 비즈니스 인텔리전스
- **멀티 테넌트**: 다중 스튜디오 지원
- **API 확장**: 외부 시스템 연동
- **세션 블록 커스터마이징**: 지점별 블록 디자인 및 색상 커스터마이징
- **고급 드래그 앤 드롭**: 세션 시간 변경, 강사 재배정 등

### 10.3 장기 계획 (1년)
- **AI 추천**: 회원 맞춤 프로그램 추천
- **IoT 연동**: 운동 기구 연동
- **글로벌 확장**: 다국어 지원
- **세션 블록 AI 분석**: 세션 패턴 분석 및 최적화 제안
- **3D 드래그 앤 드롭**: 3D 인터페이스를 통한 직관적인 공간 관리

## 11. 성공 지표 (KPI)

### 11.1 사용성 지표
- **사용자 만족도**: 4.5/5.0 이상
- **작업 완료율**: 95% 이상
- **오류 발생률**: 1% 이하

### 11.2 성능 지표
- **평균 응답 시간**: 2초 이하
- **시스템 가용성**: 99.9% 이상
- **데이터 정확성**: 99.99% 이상

### 11.3 비즈니스 지표
- **사용자 증가율**: 월 10% 이상
- **기능 사용률**: 80% 이상
- **고객 유지율**: 90% 이상

---

**문서 버전**: 1.0  
**작성일**: 2024년 12월  
**작성자**: AI Assistant  
**검토자**: 개발팀  
**승인자**: 프로젝트 매니저
